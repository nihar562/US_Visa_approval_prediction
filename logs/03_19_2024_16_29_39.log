[ 2024-03-19 16:29:42,309 ] root - INFO - Entered the start_data_ingestion method of TrainPipeline class
[ 2024-03-19 16:29:42,309 ] root - INFO - Getting the data from mongodb
[ 2024-03-19 16:29:42,309 ] root - INFO - Entered initiate_data_ingestion method of Data_Ingestion class
[ 2024-03-19 16:29:42,309 ] root - INFO - Exporting data from mongodb
[ 2024-03-19 16:29:43,020 ] root - INFO - MongoDB connection succesfull
[ 2024-03-19 16:29:59,452 ] root - INFO - Shape of dataframe: (25480, 12)
[ 2024-03-19 16:29:59,453 ] root - INFO - Saving exported data into feature store file path: artifact\03_19_2024_16_29_41\data_ingestion\feature_store\usvisa.csv
[ 2024-03-19 16:29:59,598 ] root - INFO - Got the data from mongodb
[ 2024-03-19 16:29:59,598 ] root - INFO - Entered split_data_as_train_test method of Data_Ingestion class
[ 2024-03-19 16:29:59,609 ] root - INFO - Performed train test split on the dataframe
[ 2024-03-19 16:29:59,609 ] root - INFO - Exited split_data_as_train_test method of Data_Ingestion class
[ 2024-03-19 16:29:59,610 ] root - INFO - Exporting train and test file path.
[ 2024-03-19 16:29:59,757 ] root - INFO - Exported train and test file path.
[ 2024-03-19 16:29:59,760 ] root - INFO - Performed train test split on the dataset
[ 2024-03-19 16:29:59,761 ] root - INFO - Exited initiate_data_ingestion method of Data_Ingestion class
[ 2024-03-19 16:29:59,761 ] root - INFO - Data ingestion artifact: DataIngestionArtifact(trained_file_path='artifact\\03_19_2024_16_29_41\\data_ingestion\\ingested\\train.csv', test_file_path='artifact\\03_19_2024_16_29_41\\data_ingestion\\ingested\\test.csv')
[ 2024-03-19 16:29:59,773 ] root - INFO - Got the train_set and test_set from mongodb
[ 2024-03-19 16:29:59,773 ] root - INFO - Exited the start_data_ingestion method of TrainPipeline class
[ 2024-03-19 16:29:59,773 ] root - INFO - Entered the start_data_validation method of TrainPipeline class
[ 2024-03-19 16:29:59,781 ] root - INFO - Starting data validation
[ 2024-03-19 16:29:59,887 ] root - INFO - Is required column present: [True]
[ 2024-03-19 16:29:59,887 ] root - INFO - All required columns present in training dataframe: True
[ 2024-03-19 16:29:59,887 ] root - INFO - Is required column present: [True]
[ 2024-03-19 16:29:59,887 ] root - INFO - All required columns present in testing dataframe: True
[ 2024-03-19 16:30:56,690 ] root - INFO - 1/12 drift detected.
[ 2024-03-19 16:30:56,694 ] root - INFO - Data validation artifact: DataValidationArtifact(validation_status=True, message='Drift not detected', drift_report_file_path='artifact\\03_19_2024_16_29_41\\data_validation\\drift_report\\report.yaml')
[ 2024-03-19 16:30:56,695 ] root - INFO - Performed the data validation operation
[ 2024-03-19 16:30:56,695 ] root - INFO - Exited the start_data_validation method of TrainPipeline class
[ 2024-03-19 16:30:56,705 ] root - INFO - Starting data transformation
[ 2024-03-19 16:30:56,705 ] root - INFO - Entered get_data_transformer_object method of DataTransformation class
[ 2024-03-19 16:30:56,705 ] root - INFO - Got numerical cols from schema config
[ 2024-03-19 16:30:56,706 ] root - INFO - Initialized StandardScaler, OneHotEncoder, OrdinalEncoder
[ 2024-03-19 16:30:56,706 ] root - INFO - Initialize PowerTransformer
[ 2024-03-19 16:30:56,706 ] root - INFO - Created preprocessor object from ColumnTransformer
[ 2024-03-19 16:30:56,706 ] root - INFO - Exited get_data_transformer_object method of DataTransformation class
[ 2024-03-19 16:30:56,706 ] root - INFO - Got the preprocessor object
[ 2024-03-19 16:30:56,768 ] root - INFO - Got train features and test features of Training dataset
[ 2024-03-19 16:30:56,769 ] root - INFO - Added company_age column to the Training dataset
[ 2024-03-19 16:30:56,769 ] root - INFO - drop the columns in drop_cols of Training dataset
[ 2024-03-19 16:30:56,769 ] root - INFO - Entered drop_columns methon of utils
[ 2024-03-19 16:30:56,771 ] root - INFO - Exited the drop_columns method of utils
[ 2024-03-19 16:30:56,782 ] root - INFO - Added company_age column to the Test dataset
[ 2024-03-19 16:30:56,783 ] root - INFO - Entered drop_columns methon of utils
[ 2024-03-19 16:30:56,784 ] root - INFO - Exited the drop_columns method of utils
[ 2024-03-19 16:30:56,784 ] root - INFO - drop the columns in drop_cols of Test dataset
[ 2024-03-19 16:30:56,786 ] root - INFO - Got train features and test features of Testing dataset
[ 2024-03-19 16:30:56,787 ] root - INFO - Applying preprocessing object on training dataframe and testing dataframe
[ 2024-03-19 16:30:56,903 ] root - INFO - Used the preprocessor object to fit transform the train features
[ 2024-03-19 16:30:56,928 ] root - INFO - Used the preprocessor object to transform the test features
[ 2024-03-19 16:30:56,928 ] root - INFO - Applying SMOTEENN on Training dataset
[ 2024-03-19 16:30:59,581 ] root - INFO - Applied SMOTEENN on training dataset
[ 2024-03-19 16:30:59,581 ] root - INFO - Applying SMOTEENN on testing dataset
[ 2024-03-19 16:30:59,778 ] root - INFO - Applied SMOTEENN on testing dataset
[ 2024-03-19 16:30:59,778 ] root - INFO - Created train array and test array
[ 2024-03-19 16:30:59,780 ] root - INFO - Entered the save_object method of utils
[ 2024-03-19 16:30:59,791 ] root - INFO - Exited the save_object method of utils
[ 2024-03-19 16:30:59,798 ] root - INFO - Saved the preprocessor object
[ 2024-03-19 16:30:59,799 ] root - INFO - Exited initiate_data_transformation method of Data_Transformation class
[ 2024-03-19 16:30:59,802 ] root - INFO - Entered initiate_model_trainer method of ModelTrainer class
[ 2024-03-19 16:30:59,836 ] root - INFO - Using neuro_mf to get best model object and report
[ 2024-03-19 16:30:59,845 ] neuro_mf - INFO - Started Initializing model from config file
[ 2024-03-19 16:30:59,847 ] neuro_mf - INFO - {'algorithm': 'kd_tree', 'weights': 'uniform', 'n_neighbors': 3}
[ 2024-03-19 16:30:59,847 ] neuro_mf - INFO - {'max_depth': 10, 'max_features': 'sqrt', 'n_estimators': 3}
[ 2024-03-19 16:30:59,848 ] neuro_mf - INFO - Initialized model: [InitializedModelDetail(model_serial_number='module_0', model=KNeighborsClassifier(algorithm='kd_tree', n_neighbors=3), param_grid_search={'algorithm': ['auto', 'ball_tree', 'kd_tree', 'brute'], 'weights': ['uniform', 'distance'], 'n_neighbors': [3, 5, 9]}, model_name='sklearn.neighbors.KNeighborsClassifier'), InitializedModelDetail(model_serial_number='module_1', model=RandomForestClassifier(max_depth=10, n_estimators=3), param_grid_search={'max_depth': [10, 15, 20], 'max_features': ['sqrt', 'log2'], 'n_estimators': [3, 5, 9]}, model_name='sklearn.ensemble.RandomForestClassifier')]
[ 2024-03-19 16:30:59,849 ] neuro_mf - INFO - ('**************************************************', 'training KNeighborsClassifier', '**************************************************')
[ 2024-03-19 16:30:59,849 ] neuro_mf - INFO - {'cv': 3, 'verbose': 3}
[ 2024-03-19 16:31:36,416 ] neuro_mf - INFO - ('**************************************************', 'training RandomForestClassifier', '**************************************************')
[ 2024-03-19 16:31:36,416 ] neuro_mf - INFO - {'cv': 3, 'verbose': 3}
[ 2024-03-19 16:31:45,303 ] neuro_mf - INFO - Acceptable model found:GridSearchedBestModel(model_serial_number='module_0', model=KNeighborsClassifier(algorithm='kd_tree', n_neighbors=3), best_model=KNeighborsClassifier(n_neighbors=3, weights='distance'), best_parameters={'algorithm': 'auto', 'n_neighbors': 3, 'weights': 'distance'}, best_score=0.9537087695652633)
[ 2024-03-19 16:31:45,303 ] neuro_mf - INFO - Best model: GridSearchedBestModel(model_serial_number='module_0', model=KNeighborsClassifier(algorithm='kd_tree', n_neighbors=3), best_model=KNeighborsClassifier(n_neighbors=3, weights='distance'), best_parameters={'algorithm': 'auto', 'n_neighbors': 3, 'weights': 'distance'}, best_score=0.9537087695652633)
[ 2024-03-19 16:31:45,474 ] root - INFO - Entered the load_object method of utils
[ 2024-03-19 16:31:45,486 ] root - INFO - Exited the load_object method of utils
[ 2024-03-19 16:31:45,486 ] root - INFO - Created usvisa model object with preprocessor and model
[ 2024-03-19 16:31:45,486 ] root - INFO - Created best model file path.
[ 2024-03-19 16:31:45,487 ] root - INFO - Entered the save_object method of utils
[ 2024-03-19 16:31:45,501 ] root - INFO - Exited the save_object method of utils
[ 2024-03-19 16:31:45,501 ] root - INFO - Model trainer artifact: ModelTrainerArtifact(trained_model_file_path='artifact\\03_19_2024_16_29_41\\model_trainer\\trained_model\\model.pkl', metric_artifact=ClassificationMetricArtifact(f1_score=0.8250131371518654, precision_score=0.8267509215376514, recall_score=0.8232826428945988))
